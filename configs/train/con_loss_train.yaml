# @package _global_
defaults:
  - /train
  # 【核心修改 1】使用标准的 imageCAS 数据配置 (不带 _topo 后缀)
  # 这样数据增强流程里就没有 RandTopoMaskd，完全纯净
  - override /data: MSD08
  - _self_

# 实验参数
num_shots: 3
lr: 0.00001
# 请根据你的实际显卡情况修改，之前你是 [0,1,2,3,4,5,6,7]
devices: [0,1,2,3]
run_name: con_loss # 实验名称

data_name: MSD08
loss_name: con_loss

# 路径配置：你可以指向 base.pt，也可以指向你第一轮微调后的权重
path_to_chkpt: /home/yangrui/Project/Base-model/local_results/checkpoints/base.pt
chkpt_folder: /home/yangrui/Project/Base-model/local_results/checkpoints

dataloader:
  shuffle: False

trainer:
  lightning_trainer:
    val_check_interval: 200
    max_steps: 10000
    max_epochs: 10 # 稍微多给点 epoch 保证步数跑满

  # Lightning 模块配置
  lightning_module:
    # 【核心修改 2】指向刚才修正的 con_module
    _target_: utils.MarkVSC.con_module.PLModuleConnectivityOnly
    _partial_: True
    prediction_threshold: 0.62
    batch_size: ${batch_size}
    input_size: ${input_size}

    scheduler_configs:
      cosine_annealing_few:
        interval: step
        frequency: 10
        scheduler:
          _target_: torch.optim.lr_scheduler.CosineAnnealingLR
          _partial_: True
          T_max: 1000
          eta_min: 0.0000001
          last_epoch: -1
      linear_warmup: null
      cosine_annealing: null